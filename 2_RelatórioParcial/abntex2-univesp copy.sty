\ProvidesPackage{abntex2-univesp}

%% Codificação
\usepackage[utf8]{inputenc} % Codificação de entrada
\usepackage[T1]{fontenc} % Codificação de saída

%%Fontes
% \usepackage[RMstyle={Text,Semibold},SSstyle={Text,Semibold},TTstyle={Text,Semibold},DefaultFeatures={Ligatures=Common}]{plex-otf} 
\usepackage{times}
% \renewcommand{\familydefault}{\sfdefault} % Seta fonte default
% \rmfamily

%%Outros pacotes
\usepackage{array}                  %Padding de tabelas
\usepackage{microtype} 				% para melhorias de justificação
\usepackage[dvipsnames]{xcolor} 		% para cores
\usepackage{graphicx} 			    % para imagens
%% Tamanho e alinhamento das legendas
\usepackage[singlelinecheck=false,justification=justified,font=footnotesize]{caption}
\graphicspath{{./img//}}            % Diretório das imagens
\usepackage{booktabs,tabularx,rotating,colortbl}	% para tabelas
\usepackage{mdframed} 				% para caixas de texto como na CIP do verso do título
\usepackage{multicol}				% tabelas com colunas mescladas
\usepackage{multirow}
\usepackage{lettrine}				% letras capitulares
\usepackage{xspace} 				% para nao precisar de espaços com {} depois de comandos
									% como \LaTeX e abreviações criadas pelo usuário
\usepackage{lipsum} 				% para texto de preenchimento de exemplo
\usepackage{leading}				% espaçamento entrelinhas (leading)
\usepackage{smartdiagram}           % Diagramas inteligentes

%%Espaçamento


%%Citações
    \usepackage[hyphenbreaks]{breakurl}
    \usepackage[alf,abnt-emphasize=bf,abnt-repeated-author-omit=yes]{abntex2cite} 

 % Paginas com as citações na bibl
    \usepackage[brazilian,hyperpageref]{backref}	
    \renewcommand{\backrefpagesname}{Citado na(s) página(s):~}
    \renewcommand{\backref}{}
    \renewcommand*{\backrefalt}[4]{
        \ifcase #1%
        Nenhuma citação no texto.%
        \or
        Citado na página #2.%
        \else
        Citado #1 vezes nas páginas #2.%
        \fi}%


%%Hiperlinks
    \usepackage{hyperref}               
    \hypersetup{hidelinks}
    \urlstyle{same}


%%Cabeçalho
%% Cabeçalho padrao
    \makepagestyle{abntheadings}
    \makeevenhead{abntheadings}{\ABNTEXfontereduzida\thepage}{}{\ABNTEXfontereduzida\textit\leftmark}
    \makeoddhead{abntheadings}{}{}{\ABNTEXfontereduzida\thepage}
    % \makeheadrule{abntheadings}{0pt}{\normalrulethickness}              
%%Cabeçalho com logos, números de página no rodapé
    % \usepackage{makecell}

%%Estilo de página com figuars no cabeçalho
    % \usepackage{fancyhdr} 
    % \pagestyle{fancy}
    %     \fancyhf{}
    %     \renewcommand{\headrulewidth}{0pt}
    %     \newcommand{\headfont}{\fontsize{8}{9}\selectfont}
    %     \fancypagestyle{logos}{
    %         \setlength{\headheight}{45pt}
    %         \addtolength{\topmargin}{-15pt}
    %         \addtolength{\footskip}{-12pt}
    %         \fancyhead[L]{
    %             \mbox{\makecell[cl]{
    %                 \includegraphics[height=35pt]{img/logo_univesp.png}}
    %             }
    %         }
    %         \fancyhead[R]{
    %             \mbox{\makecell[cl]{
    %                 \includegraphics[height=35pt]{img/logoPI.png}}
    %             }
    %         }
    %         \fancyfoot[R]{\headfont\thepage}
    %     }



% Estilos
%% Membros da banca
    \newcommand{\membrobancaA}{}
    \newcommand{\membrobancaB}{}
    \newcommand{\membrobancaC}{}

    \providecommand{\imprimirmembrobancaA}{}
    \providecommand{\imprimirmembrobancaAinst}{}
    \renewcommand{\membrobancaA}[2][\imprimirinstituicao]{\renewcommand{\imprimirmembrobancaA}{#2}\renewcommand{\imprimirmembrobancaAinst}{#1}}

    \providecommand{\imprimirmembrobancaB}{}
    \providecommand{\imprimirmembrobancaBinst}{}
    \renewcommand{\membrobancaB}[2][\imprimirinstituicao]{\renewcommand{\imprimirmembrobancaB}{#2}\renewcommand{\imprimirmembrobancaBinst}{#1}}

    \providecommand{\imprimirmembrobancaC}{}
    \providecommand{\imprimirmembrobancaCinst}{}
    \renewcommand{\membrobancaC}[2][\imprimirinstituicao]{\renewcommand{\imprimirmembrobancaC}{#2}\renewcommand{\imprimirmembrobancaCinst}{#1}}

    \newcommand{\imprimirmeOrientadorinst}{\imprimirinstituicao}
    \newcommand{\imprimirmeCoorientadorinst}{\imprimirinstituicao}

    %% Natureza do trabalho
    \providecommand{\imprimirnaturezatrabalho}{}
    \newcommand{\naturezatrabalho}[1]{
        \renewcommand{\imprimirnaturezatrabalho}{#1}
    }

%% Redefinir capa
    \renewcommand{\imprimircapa}{
        \begin{capa}
            \begin{center}


                \large{\textbf{\MakeUppercase\imprimirinstituicao}}\\
                \vfill
                \large{\imprimirautor}
                \vfill
                % \includegraphics[height=2.5cm, width=7.1cm]{logo_univesp}\par

                % \vfill
                \large{\textbf{\imprimirtitulo}}
                \vfill
                \begin{normalsize}
                \imprimirlocal\\
                \imprimirdata
                \end{normalsize}
            \end{center}
        \end{capa}
    }

%% Redefinir folha de rosto
    \renewcommand{\folhaderostocontent}{
        \begin{center}
            \large{\textbf{\MakeUppercase\imprimirinstituicao}}

            \vspace*{\fill}

            \large{\imprimirautor}

            \vspace*{\fill}

            \large{\textbf{\imprimirtitulo}}

            \vspace*{\fill}
            
            \abntex@ifnotempty{\imprimirpreambulo}{
                \hspace{.45\textwidth}
                \begin{minipage}{.5\textwidth}
                    \begin{normalsize}
                        \imprimirpreambulo
                    \end{normalsize}
                \end{minipage}
            }

            \vspace*{\fill}

            \abntex@ifnotempty{\imprimirorientador}{
                \begin{center}
                    \imprimirorientadorRotulo~\imprimirorientador\par
                    \abntex@ifnotempty{\imprimircoorientador}{
                        {\imprimircoorientadorRotulo~\imprimircoorientador}
                    }
                \end{center}
            }

            \vspace*{\fill}
            \begin{normalsize}

            \imprimirlocal\\
            \imprimirdata
            \end{normalsize}
        \end{center}
    }

%% Definir folha de aprovação
    \newcommand{\imprimirfolhadeaprovacao}{
        \begin{folhadeaprovacao}
            \begin{center}
                \textbf{\MakeUppercase\imprimirinstituicao}

                \vspace*{\fill}

                \imprimirautor

                \vspace*{\fill}

                \textbf{\imprimirtitulo}

                \vspace*{\fill}

                \hspace{.45\textwidth}
                \begin{minipage}{.5\textwidth}
                    \begin{scriptsize}
                        \begin{SingleSpace}
                            \imprimirnaturezatrabalho
                        \end{SingleSpace}
                    \end{scriptsize}	
                    
                \end{minipage}

                \vspace*{\fill}

                \imprimirlocal, \today

                \vspace*{\fill}

                \abntex@ifnotempty{\imprimirmembrobancaA}{
                    \assinatura{\imprimirmembrobancaA \par \imprimirmembrobancaAinst}
                }
                \abntex@ifnotempty{\imprimirmembrobancaB}{
                    \assinatura{\imprimirmembrobancaB \par \imprimirmembrobancaBinst}
                }
                \abntex@ifnotempty{\imprimirmembrobancaC}{
                    \assinatura{\imprimirmembrobancaC \par \imprimirmembrobancaCinst}
                }
            \end{center}
        \end{folhadeaprovacao}
    }

%% Redefinir dedicatória
    \renewenvironment{dedicatoria}[1][]
    {
            \ifthenelse{\equal{#1}{}}{
                    \PRIVATEbookmarkthis{\dedicatorianame}
            }{\preamblealchapter{#1}}

            \vspace*{\fill}

        \begin{flushright}
            \hbox{}\vfill
            \begin{minipage}{.5\textwidth}
                                    \setlength\parindent{0pt}
                                    \setlength\parskip{12pt}
    }
    {
                    \end{minipage}
            \end{flushright}
    }

\renewenvironment{epigrafe}[1][]
    {
            \ifthenelse{\equal{#1}{}}{
                    \PRIVATEbookmarkthis{\epigraphname}
            }{\pretextualchapter{#1}}

            \vspace*{\fill}
    }


%% Comando para inserir sigla
    \newcommand{\sigla}[2][]{
        \item[#1] \textit{#2}
    }
    


%% Redefinição da formatação do \chapter
    \renewcommand{\ABNTEXchapterfont}{\MakeUppercase\normalfont\fontseries{b}\selectfont}
    \renewcommand{\ABNTEXchapterfontsize}{\normalsize}
    \renewcommand{\ABNTEXpartfont}{\fontseries{b}\selectfont\selectfont}
    \renewcommand{\ABNTEXpartfontsize}{\normalsize}
    \renewcommand{\ABNTEXsectionfont}{\MakeUppercase\normalfont\fontseries{b}\selectfont}
    \renewcommand{\ABNTEXsectionfontsize}{\normalsize}
    \renewcommand{\ABNTEXsubsectionfont}{\normalfont}%\fontseries{b}\selectfont}
    \renewcommand{\ABNTEXsubsectionfontsize}{\normalsize}
    \renewcommand{\ABNTEXsubsubsectionfont}{\normalfont\selectfont}
    \renewcommand{\ABNTEXsubsubsectionfontsize}{\normalsize}
    \renewcommand{\ABNTEXsubsubsubsectionfont}{\normalfont\itshape\selectfont}
    \renewcommand{\ABNTEXsubsubsubsectionfontsize}{\normalsize}




%%Seções em arábicos
    \renewcommand\thesection{\arabic{section}}




%% Redefinição da formatação de Parágrafos 
    \setlength{\parindent}{1cm}
    \setlength{\parskip}{0cm}

%% Sumário
    % \usepackage{tocloft}
    % \renewcommand*{\cftsectionfont}{\normalfont}
    \renewcommand*{\cftsubsubsectionfont}{\normalfont}
    \renewcommand*{\cftparagraphfont}{\normalfont\itshape}

%% Páginas em formato paisagem
    \usepackage{pdflscape}

    \usepackage{afterpage}

    % Redefinição do cabeçalho e rodapé para páginas em paisagem
    % \fancypagestyle{landscape}{
    %     \fancyhf{}
    %     \renewcommand{\headrulewidth}{0pt}
    %     \newcommand{\headfont}{\fontsize{8}{9}\selectfont}
    %     \fancyhead[L]{
    %         \rotatebox{90}{
    %             \mbox{\makecell[cl]{
    %                 \includegraphics[height=35pt]{img/logo_univesp.png}
    %             }}
    %         }
    %     }
    %     \fancyhead[R]{
    %         \rotatebox{90}{
    %             \mbox{\makecell[cl]{
    %                 \includegraphics[height=35pt]{img/logoPI.png}
    %             }}
    %         }
    %     }
    %     \fancyfoot[R]{\rotatebox{90}{\headfont\thepage}}
    % }
    
    % Comando para aplicar o estilo landscape em páginas em paisagem
    \newcommand{\applyLandscapeStyle}{
        \afterpage{%
            \global\let\ps@headings\ps@landscape%
            \global\let\ps@fancy\ps@landscape%
        }
    }

%% Tornar a entrada "Referências" com fonte em maiúscula
    \addto\captionsbrazil{
        \renewcommand{\bibname}{REFER\^ENCIAS}
    }

% Legendas
\makeatletter
\patchcmd{\caption@@@make}
  {\ifcaption@star}
    {\ifcaption@star\small}
    {}{}
\makeatother

\setcounter{secnumdepth}{1}
